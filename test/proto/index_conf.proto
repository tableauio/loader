syntax = "proto3";

package protoconf;

import "tableau/protobuf/tableau.proto";
import "common_conf.proto";

option go_package = "github.com/tableauio/loader/test/go-tableau-loader/protoconf";
option (tableau.workbook) = {
  name: "Index.xlsx"
};

// Nesting: map -> map
message FruitConf {
  option (tableau.worksheet) = {
    name: "FruitConf"
    ordered_index: "Price<ID>"
  };

  map<int32, Fruit> fruit_map = 1 [(tableau.field) = { key: "FruitType" layout: LAYOUT_VERTICAL }];
  message Fruit {
    protoconf.FruitType fruit_type = 1 [(tableau.field) = { name: "FruitType" }];
    map<int32, Item> item_map = 2 [(tableau.field) = { key: "ID" layout: LAYOUT_VERTICAL }];
    message Item {
      int32 id = 1 [(tableau.field) = { name: "ID" }];
      int32 price = 2 [(tableau.field) = { name: "Price" }];
    }
  }
}

// Nesting: map -> list -> map -> list
message Fruit2Conf {
  option (tableau.worksheet) = {
    name: "Fruit2Conf"
    index: "CountryName"
    index: "CountryItemAttrName"
    ordered_index: "CountryItemPrice<CountryItemID>"
  };

  map<int32, Fruit> fruit_map = 1 [(tableau.field) = { key: "FruitType" layout: LAYOUT_VERTICAL }];
  message Fruit {
    protoconf.FruitType fruit_type = 1 [(tableau.field) = { name: "FruitType" }];
    repeated Country country_list = 2 [(tableau.field) = { name: "Country" layout: LAYOUT_HORIZONTAL }];
    message Country {
      int32 id = 1 [(tableau.field) = { name: "ID" }];
      string name = 2 [(tableau.field) = { name: "Name" }];
      map<int32, Item> item_map = 3 [(tableau.field) = { name: "Item" key: "ID" layout: LAYOUT_HORIZONTAL }];
      message Item {
        int32 id = 1 [(tableau.field) = { name: "ID" }];
        int32 price = 2 [(tableau.field) = { name: "Price" }];
        repeated Attr attr_list = 3 [(tableau.field) = { name: "Attr" layout: LAYOUT_HORIZONTAL }];
        message Attr {
          string name = 1 [(tableau.field) = { name: "Name" }];
          int32 value = 2 [(tableau.field) = { name: "Value" }];
        }
      }
    }
  }
}

// Nesting: list -> list -> map -> list
message Fruit3Conf {
  option (tableau.worksheet) = {
    name: "Fruit2Conf"
    index: "CountryName"
    index: "CountryItemAttrName"
    ordered_index: "CountryItemPrice<CountryItemID>"
  };

  repeated Fruit fruit_list = 1 [(tableau.field) = { layout: LAYOUT_VERTICAL }];
  message Fruit {
    protoconf.FruitType fruit_type = 1 [(tableau.field) = { name: "FruitType" }];
    repeated Country country_list = 2 [(tableau.field) = { name: "Country" layout: LAYOUT_HORIZONTAL }];
    message Country {
      int32 id = 1 [(tableau.field) = { name: "ID" }];
      string name = 2 [(tableau.field) = { name: "Name" }];
      map<int32, Item> item_map = 3 [(tableau.field) = { name: "Item" key: "ID" layout: LAYOUT_HORIZONTAL }];
      message Item {
        int32 id = 1 [(tableau.field) = { name: "ID" }];
        int32 price = 2 [(tableau.field) = { name: "Price" }];
        repeated Attr attr_list = 3 [(tableau.field) = { name: "Attr" layout: LAYOUT_HORIZONTAL }];
        message Attr {
          string name = 1 [(tableau.field) = { name: "Name" }];
          int32 value = 2 [(tableau.field) = { name: "Value" }];
        }
      }
    }
  }
}

// Nesting: map -> map -> map -> list
message Fruit4Conf {
  option (tableau.worksheet) = {
    name: "Fruit4Conf"
    index: "CountryName"
    index: "CountryItemAttrName"
    ordered_index: "CountryItemPrice<CountryItemID>"
  };

  map<int32, Fruit> fruit_map = 1 [(tableau.field) = { key: "FruitType" layout: LAYOUT_VERTICAL }];
  message Fruit {
    protoconf.FruitType fruit_type = 1 [(tableau.field) = { name: "FruitType" }];
    map<int32, Country> country_map = 2 [(tableau.field) = { name: "Country" key: "ID" layout: LAYOUT_HORIZONTAL }];
    message Country {
      int32 id = 1 [(tableau.field) = { name: "ID" }];
      string name = 2 [(tableau.field) = { name: "Name" }];
      map<int32, Item> item_map = 3 [(tableau.field) = { name: "Item" key: "ID" layout: LAYOUT_HORIZONTAL }];
      message Item {
        int32 id = 1 [(tableau.field) = { name: "ID" }];
        int32 price = 2 [(tableau.field) = { name: "Price" }];
        repeated Attr attr_list = 3 [(tableau.field) = { name: "Attr" layout: LAYOUT_HORIZONTAL }];
        message Attr {
          string name = 1 [(tableau.field) = { name: "Name" }];
          int32 value = 2 [(tableau.field) = { name: "Value" }];
        }
      }
    }
  }
}
// <auto-generated>
// Code generated by protoc-gen-csharp-tableau-loader. DO NOT EDIT.
// versions:
// - protoc-gen-csharp-tableau-loader v0.1.0
// - protoc                           v3.19.3
// source: item_conf.proto
// </auto-generated>
#nullable enable
using pb = global::Google.Protobuf;
namespace Tableau
{
    public class ItemConf : Messager, IMessagerName
    {
        // OrderedMap types.
        public class OrderedMap_ItemMap : SortedDictionary<uint, Protoconf.ItemConf.Types.Item>;

        private OrderedMap_ItemMap _orderedMap = [];

        // Index types.
        // Index: Type
        public class Index_ItemMap : Dictionary<Protoconf.FruitType, List<Protoconf.ItemConf.Types.Item>>;

        private Index_ItemMap _indexItemMap = [];

        // Index: Param<ID>@ItemInfo
        public class Index_ItemInfoMap : Dictionary<int, List<Protoconf.ItemConf.Types.Item>>;

        private Index_ItemInfoMap _indexItemInfoMap = [];

        // Index: Default@ItemDefaultInfo
        public class Index_ItemDefaultInfoMap : Dictionary<string, List<Protoconf.ItemConf.Types.Item>>;

        private Index_ItemDefaultInfoMap _indexItemDefaultInfoMap = [];

        // Index: ExtType@ItemExtInfo
        public class Index_ItemExtInfoMap : Dictionary<Protoconf.FruitType, List<Protoconf.ItemConf.Types.Item>>;

        private Index_ItemExtInfoMap _indexItemExtInfoMap = [];

        // Index: (ID,Name)<Type,UseEffectType>@AwardItem
        public readonly struct Index_AwardItemKey : IEquatable<Index_AwardItemKey>
        {
            public uint Id { get; }
            public string Name { get; }

            public Index_AwardItemKey(uint id, string name)
            {
                Id = id;
                Name = name;
            }

            public bool Equals(Index_AwardItemKey other) =>
                (Id, Name).Equals((other.Id, other.Name));

            public override int GetHashCode() =>
                (Id, Name).GetHashCode();
        }

        public class Index_AwardItemMap : Dictionary<Index_AwardItemKey, List<Protoconf.ItemConf.Types.Item>>;

        private Index_AwardItemMap _indexAwardItemMap = [];

        // Index: (ID,Type,Param,ExtType)@SpecialItem
        public readonly struct Index_SpecialItemKey : IEquatable<Index_SpecialItemKey>
        {
            public uint Id { get; }
            public Protoconf.FruitType Type { get; }
            public int Param { get; }
            public Protoconf.FruitType ExtType { get; }

            public Index_SpecialItemKey(uint id, Protoconf.FruitType type, int param, Protoconf.FruitType extType)
            {
                Id = id;
                Type = type;
                Param = param;
                ExtType = extType;
            }

            public bool Equals(Index_SpecialItemKey other) =>
                (Id, Type, Param, ExtType).Equals((other.Id, other.Type, other.Param, other.ExtType));

            public override int GetHashCode() =>
                (Id, Type, Param, ExtType).GetHashCode();
        }

        public class Index_SpecialItemMap : Dictionary<Index_SpecialItemKey, List<Protoconf.ItemConf.Types.Item>>;

        private Index_SpecialItemMap _indexSpecialItemMap = [];

        // Index: PathDir@ItemPathDir
        public class Index_ItemPathDirMap : Dictionary<string, List<Protoconf.ItemConf.Types.Item>>;

        private Index_ItemPathDirMap _indexItemPathDirMap = [];

        // Index: PathName@ItemPathName
        public class Index_ItemPathNameMap : Dictionary<string, List<Protoconf.ItemConf.Types.Item>>;

        private Index_ItemPathNameMap _indexItemPathNameMap = [];

        // Index: PathFriendID@ItemPathFriendID
        public class Index_ItemPathFriendIDMap : Dictionary<uint, List<Protoconf.ItemConf.Types.Item>>;

        private Index_ItemPathFriendIDMap _indexItemPathFriendIdMap = [];

        // Index: UseEffectType@UseEffectType
        public class Index_UseEffectTypeMap : Dictionary<Protoconf.UseEffect.Types.Type, List<Protoconf.ItemConf.Types.Item>>;

        private Index_UseEffectTypeMap _indexUseEffectTypeMap = [];

        // OrderedIndex types.
        // OrderedIndex: ExtType@ExtType
        public class OrderedIndex_ExtTypeMap : SortedDictionary<Protoconf.FruitType, List<Protoconf.ItemConf.Types.Item>>;

        private OrderedIndex_ExtTypeMap _orderedIndexExtTypeMap = [];

        // OrderedIndex: (Param,ExtType)<ID>@ParamExtType
        public readonly struct OrderedIndex_ParamExtTypeKey : IComparable<OrderedIndex_ParamExtTypeKey>
        {
            public int Param { get; }
            public Protoconf.FruitType ExtType { get; }

            public OrderedIndex_ParamExtTypeKey(int param, Protoconf.FruitType extType)
            {
                Param = param;
                ExtType = extType;
            }

            public int CompareTo(OrderedIndex_ParamExtTypeKey other) =>
                (Param, ExtType).CompareTo((other.Param, other.ExtType));
        }

        public class OrderedIndex_ParamExtTypeMap : SortedDictionary<OrderedIndex_ParamExtTypeKey, List<Protoconf.ItemConf.Types.Item>>;

        private OrderedIndex_ParamExtTypeMap _orderedIndexParamExtTypeMap = [];

        private Protoconf.ItemConf _data = new();

        public static string Name() => Protoconf.ItemConf.Descriptor.Name;

        public override bool Load(string dir, Format fmt, in Load.MessagerOptions? options = null)
        {
            var start = DateTime.Now;
            try
            {
                _data = (Protoconf.ItemConf)(
                    Tableau.Load.LoadMessagerInDir(Protoconf.ItemConf.Descriptor, dir, fmt, options)
                    ?? throw new InvalidOperationException()
                );
            }
            catch (Exception)
            {
                return false;
            }
            LoadStats.Duration = DateTime.Now - start;
            return ProcessAfterLoad();
        }

        public ref readonly Protoconf.ItemConf Data() => ref _data;

        public override pb::IMessage? Message() => _data;

        protected override bool ProcessAfterLoad()
        {
            // OrderedMap init.
            _orderedMap.Clear();
            foreach (var (key1, value1) in _data.ItemMap)
            {
                _orderedMap[key1] = value1;
            }
            // Index init.
            _indexItemMap.Clear();
            _indexItemInfoMap.Clear();
            _indexItemDefaultInfoMap.Clear();
            _indexItemExtInfoMap.Clear();
            _indexAwardItemMap.Clear();
            _indexSpecialItemMap.Clear();
            _indexItemPathDirMap.Clear();
            _indexItemPathNameMap.Clear();
            _indexItemPathFriendIdMap.Clear();
            _indexUseEffectTypeMap.Clear();
            foreach (var item1 in _data.ItemMap)
            {
                var k1 = item1.Key;
                {
                    // Index: Type
                    var key = item1.Value.Type;
                    {
                        var list = _indexItemMap.TryGetValue(key, out var existingList) ?
                        existingList : _indexItemMap[key] = [];
                        list.Add(item1.Value);
                    }
                }
                {
                    // Index: Param<ID>@ItemInfo
                    foreach (var item2 in item1.Value.ParamList ?? Enumerable.Empty<int>())
                    {
                        {
                            var list = _indexItemInfoMap.TryGetValue(item2, out var existingList) ?
                            existingList : _indexItemInfoMap[item2] = [];
                            list.Add(item1.Value);
                        }
                    }
                }
                {
                    // Index: Default@ItemDefaultInfo
                    var key = item1.Value.Default;
                    {
                        var list = _indexItemDefaultInfoMap.TryGetValue(key, out var existingList) ?
                        existingList : _indexItemDefaultInfoMap[key] = [];
                        list.Add(item1.Value);
                    }
                }
                {
                    // Index: ExtType@ItemExtInfo
                    foreach (var item2 in item1.Value.ExtTypeList ?? Enumerable.Empty<Protoconf.FruitType>())
                    {
                        {
                            var list = _indexItemExtInfoMap.TryGetValue(item2, out var existingList) ?
                            existingList : _indexItemExtInfoMap[item2] = [];
                            list.Add(item1.Value);
                        }
                    }
                }
                {
                    // Index: (ID,Name)<Type,UseEffectType>@AwardItem
                    var key = new Index_AwardItemKey(item1.Value.Id, item1.Value.Name);
                    {
                        var list = _indexAwardItemMap.TryGetValue(key, out var existingList) ?
                        existingList : _indexAwardItemMap[key] = [];
                        list.Add(item1.Value);
                    }
                }
                {
                    // Index: (ID,Type,Param,ExtType)@SpecialItem
                    foreach (var indexItem2 in item1.Value.ParamList ?? Enumerable.Empty<int>())
                    {
                        foreach (var indexItem3 in item1.Value.ExtTypeList ?? Enumerable.Empty<Protoconf.FruitType>())
                        {
                            var key = new Index_SpecialItemKey(item1.Value.Id, item1.Value.Type, indexItem2, indexItem3);
                            {
                                var list = _indexSpecialItemMap.TryGetValue(key, out var existingList) ?
                                existingList : _indexSpecialItemMap[key] = [];
                                list.Add(item1.Value);
                            }
                        }
                    }
                }
                {
                    // Index: PathDir@ItemPathDir
                    var key = item1.Value.Path?.Dir ?? "";
                    {
                        var list = _indexItemPathDirMap.TryGetValue(key, out var existingList) ?
                        existingList : _indexItemPathDirMap[key] = [];
                        list.Add(item1.Value);
                    }
                }
                {
                    // Index: PathName@ItemPathName
                    foreach (var item2 in item1.Value.Path?.NameList ?? Enumerable.Empty<string>())
                    {
                        {
                            var list = _indexItemPathNameMap.TryGetValue(item2, out var existingList) ?
                            existingList : _indexItemPathNameMap[item2] = [];
                            list.Add(item1.Value);
                        }
                    }
                }
                {
                    // Index: PathFriendID@ItemPathFriendID
                    var key = item1.Value.Path?.Friend?.Id ?? 0;
                    {
                        var list = _indexItemPathFriendIdMap.TryGetValue(key, out var existingList) ?
                        existingList : _indexItemPathFriendIdMap[key] = [];
                        list.Add(item1.Value);
                    }
                }
                {
                    // Index: UseEffectType@UseEffectType
                    var key = item1.Value.UseEffect?.Type ?? 0;
                    {
                        var list = _indexUseEffectTypeMap.TryGetValue(key, out var existingList) ?
                        existingList : _indexUseEffectTypeMap[key] = [];
                        list.Add(item1.Value);
                    }
                }
            }
            // Index(sort): Param<ID>@ItemInfo
            Comparison<Protoconf.ItemConf.Types.Item> indexItemInfoMapComparison = (a, b) =>
                (a.Id).CompareTo((b.Id));
            foreach (var itemList in _indexItemInfoMap.Values)
            {
                itemList.Sort(indexItemInfoMapComparison);
            }
            // Index(sort): (ID,Name)<Type,UseEffectType>@AwardItem
            Comparison<Protoconf.ItemConf.Types.Item> indexAwardItemMapComparison = (a, b) =>
                (a.Type, a.UseEffect?.Type ?? 0).CompareTo((b.Type, b.UseEffect?.Type ?? 0));
            foreach (var itemList in _indexAwardItemMap.Values)
            {
                itemList.Sort(indexAwardItemMapComparison);
            }
            // OrderedIndex init.
            _orderedIndexExtTypeMap.Clear();
            _orderedIndexParamExtTypeMap.Clear();
            foreach (var item1 in _data.ItemMap)
            {
                var k1 = item1.Key;
                {
                    // OrderedIndex: ExtType@ExtType
                    foreach (var item2 in item1.Value.ExtTypeList ?? Enumerable.Empty<Protoconf.FruitType>())
                    {
                        var key = item2;
                        {
                            var list = _orderedIndexExtTypeMap.TryGetValue(key, out var existingList) ?
                            existingList : _orderedIndexExtTypeMap[key] = [];
                            list.Add(item1.Value);
                        }
                    }
                }
                {
                    // OrderedIndex: (Param,ExtType)<ID>@ParamExtType
                    foreach (var indexItem0 in item1.Value.ParamList ?? Enumerable.Empty<int>())
                    {
                        foreach (var indexItem1 in item1.Value.ExtTypeList ?? Enumerable.Empty<Protoconf.FruitType>())
                        {
                            var key = new OrderedIndex_ParamExtTypeKey(indexItem0, indexItem1);
                            {
                                var list = _orderedIndexParamExtTypeMap.TryGetValue(key, out var existingList) ?
                                existingList : _orderedIndexParamExtTypeMap[key] = [];
                                list.Add(item1.Value);
                            }
                        }
                    }
                }
            }
            // OrderedIndex(sort): (Param,ExtType)<ID>@ParamExtType
            Comparison<Protoconf.ItemConf.Types.Item> orderedIndexParamExtTypeMapComparison = (a, b) =>
                (a.Id).CompareTo((b.Id));
            foreach (var itemList in _orderedIndexParamExtTypeMap.Values)
            {
                itemList.Sort(orderedIndexParamExtTypeMapComparison);
            }
            return true;
        }

        public Protoconf.ItemConf.Types.Item? Get1(uint id) =>
            _data.ItemMap?.TryGetValue(id, out var val) == true ? val : null;

        // OrderedMap accessers.
        public ref readonly OrderedMap_ItemMap GetOrderedMap() => ref _orderedMap;

        // Index: Type
        public ref readonly Index_ItemMap FindItemMap() => ref _indexItemMap;

        public List<Protoconf.ItemConf.Types.Item>? FindItem(Protoconf.FruitType type) =>
            _indexItemMap.TryGetValue(type, out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstItem(Protoconf.FruitType type) =>
            FindItem(type)?.FirstOrDefault();

        // Index: Param<ID>@ItemInfo
        public ref readonly Index_ItemInfoMap FindItemInfoMap() => ref _indexItemInfoMap;

        public List<Protoconf.ItemConf.Types.Item>? FindItemInfo(int param) =>
            _indexItemInfoMap.TryGetValue(param, out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstItemInfo(int param) =>
            FindItemInfo(param)?.FirstOrDefault();

        // Index: Default@ItemDefaultInfo
        public ref readonly Index_ItemDefaultInfoMap FindItemDefaultInfoMap() => ref _indexItemDefaultInfoMap;

        public List<Protoconf.ItemConf.Types.Item>? FindItemDefaultInfo(string default_) =>
            _indexItemDefaultInfoMap.TryGetValue(default_, out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstItemDefaultInfo(string default_) =>
            FindItemDefaultInfo(default_)?.FirstOrDefault();

        // Index: ExtType@ItemExtInfo
        public ref readonly Index_ItemExtInfoMap FindItemExtInfoMap() => ref _indexItemExtInfoMap;

        public List<Protoconf.ItemConf.Types.Item>? FindItemExtInfo(Protoconf.FruitType extType) =>
            _indexItemExtInfoMap.TryGetValue(extType, out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstItemExtInfo(Protoconf.FruitType extType) =>
            FindItemExtInfo(extType)?.FirstOrDefault();

        // Index: (ID,Name)<Type,UseEffectType>@AwardItem
        public ref readonly Index_AwardItemMap FindAwardItemMap() => ref _indexAwardItemMap;

        public List<Protoconf.ItemConf.Types.Item>? FindAwardItem(uint id, string name) =>
            _indexAwardItemMap.TryGetValue(new Index_AwardItemKey(id, name), out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstAwardItem(uint id, string name) =>
            FindAwardItem(id, name)?.FirstOrDefault();

        // Index: (ID,Type,Param,ExtType)@SpecialItem
        public ref readonly Index_SpecialItemMap FindSpecialItemMap() => ref _indexSpecialItemMap;

        public List<Protoconf.ItemConf.Types.Item>? FindSpecialItem(uint id, Protoconf.FruitType type, int param, Protoconf.FruitType extType) =>
            _indexSpecialItemMap.TryGetValue(new Index_SpecialItemKey(id, type, param, extType), out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstSpecialItem(uint id, Protoconf.FruitType type, int param, Protoconf.FruitType extType) =>
            FindSpecialItem(id, type, param, extType)?.FirstOrDefault();

        // Index: PathDir@ItemPathDir
        public ref readonly Index_ItemPathDirMap FindItemPathDirMap() => ref _indexItemPathDirMap;

        public List<Protoconf.ItemConf.Types.Item>? FindItemPathDir(string dir) =>
            _indexItemPathDirMap.TryGetValue(dir, out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstItemPathDir(string dir) =>
            FindItemPathDir(dir)?.FirstOrDefault();

        // Index: PathName@ItemPathName
        public ref readonly Index_ItemPathNameMap FindItemPathNameMap() => ref _indexItemPathNameMap;

        public List<Protoconf.ItemConf.Types.Item>? FindItemPathName(string name) =>
            _indexItemPathNameMap.TryGetValue(name, out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstItemPathName(string name) =>
            FindItemPathName(name)?.FirstOrDefault();

        // Index: PathFriendID@ItemPathFriendID
        public ref readonly Index_ItemPathFriendIDMap FindItemPathFriendIDMap() => ref _indexItemPathFriendIdMap;

        public List<Protoconf.ItemConf.Types.Item>? FindItemPathFriendID(uint id) =>
            _indexItemPathFriendIdMap.TryGetValue(id, out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstItemPathFriendID(uint id) =>
            FindItemPathFriendID(id)?.FirstOrDefault();

        // Index: UseEffectType@UseEffectType
        public ref readonly Index_UseEffectTypeMap FindUseEffectTypeMap() => ref _indexUseEffectTypeMap;

        public List<Protoconf.ItemConf.Types.Item>? FindUseEffectType(Protoconf.UseEffect.Types.Type type) =>
            _indexUseEffectTypeMap.TryGetValue(type, out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstUseEffectType(Protoconf.UseEffect.Types.Type type) =>
            FindUseEffectType(type)?.FirstOrDefault();

        // OrderedIndex: ExtType@ExtType
        public ref readonly OrderedIndex_ExtTypeMap FindExtTypeMap() => ref _orderedIndexExtTypeMap;

        public List<Protoconf.ItemConf.Types.Item>? FindExtType(Protoconf.FruitType extType) =>
            _orderedIndexExtTypeMap.TryGetValue(extType, out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstExtType(Protoconf.FruitType extType) =>
            FindExtType(extType)?.FirstOrDefault();

        // OrderedIndex: (Param,ExtType)<ID>@ParamExtType
        public ref readonly OrderedIndex_ParamExtTypeMap FindParamExtTypeMap() => ref _orderedIndexParamExtTypeMap;

        public List<Protoconf.ItemConf.Types.Item>? FindParamExtType(int param, Protoconf.FruitType extType) =>
            _orderedIndexParamExtTypeMap.TryGetValue(new OrderedIndex_ParamExtTypeKey(param, extType), out var value) ? value : null;

        public Protoconf.ItemConf.Types.Item? FindFirstParamExtType(int param, Protoconf.FruitType extType) =>
            FindParamExtType(param, extType)?.FirstOrDefault();
    }
}
